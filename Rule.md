# Lang Wars - JavaChallenge 2014
## ゲームの概要

あなたはプログラマ。プログラミング言語を勉強して信仰度を上げよう。
ライバルたちを出し抜いて、プログラミング言語界の法王になれ！

## ルールの疑似コード

自然プログラミング言語よりコードをご希望の方に向けて、[ルールの疑似コード](#PseudoCode)を用意した。

## ゲームの目的

_プログラミング言語_ に対する _信仰度_ によって決まる _信者数_ を、他の _プレイヤー_ より多く獲得する。

## ゲームの大まかな流れ

プレイヤーは4人、プログラミング言語は8種類ある。

このゲームはターン制であり、各ターンごとに、プレイヤーたちは好きなプログラミング言語を _勉強_ して信仰度をためる。
勉強の情報は一部が隠されているため、他のプレイヤーとの駆け引きが重要となる。

10ターンでゲームが終了し、プレイヤーたちはそれぞれのプログラミング言語に対する信仰度に応じて信者数を獲得する。
プログラミング言語に対する信仰度が最も高いプレイヤーはそのプログラミング言語から信者数をもらえるが、信仰度が最も低いプレイヤーは信者数を失ってしまう。
したがって、目当てのプログラミング言語を積極的に勉強して他プレイヤーより多くの信仰度をためつつ、他のプログラミング言語に対する信仰度にも気を使って失点を防ぐことが重要である。
信者数を最も多く獲得したプレイヤーの勝利となる。

## ゲームの開始

ゲームが開始すると、まずそれぞれのプログラミング言語に _注目度_ が3から6の間でランダムに設定され、プレイヤーに公開される。
注目度が高いプログラミング言語ほど、ゲーム終了時にもらえる（または失う）信者数が多くなる。

## ターンの流れ

ターンには _平日_ ターンと _休日_ ターンが存在する。
1ターン目は平日であり、1ターンごとに平日と休日が入れ替わる。
つまり、2ターンで一週間となる。

ターンが始まると、プレイヤーたちは一斉に勉強言語を選ぶ。
平日では1ターンで5回（5日分）勉強をするが、休日では1ターンに2回（2日分）勉強する。
1回の勉強では1種類の言語を勉強をし、自分の勉強した言語に対する信仰度が1上がる。
1ターン中の勉強言語の割り振りは自由である。
例えば平日であれば、バラバラの5言語を1回ずつ勉強しても良いし、同じ言語を5回勉強しても良い。
なお、勉強言語が他のプレイヤーと被っても、信仰度はそれぞれ通常通り上昇する。

全プレイヤーが勉強言語を選んだら、プログラミング言語に対する信仰度が計算される。
そのターンが平日なら、誰が誰と勉強したか全員に公開される。
休日の場合は、どのプログラミング言語が勉強を1回以上したかのみ公開される。

下の表は、平日と休日の勉強の特徴をまとめたものである。

|                     | 平日 | 休日 |
| ------------------- | ---- | ---- |
| 勉強回数            | 5    | 2    |
| 勉強1回で上がる信仰度 | 1    | 1    |
| 勉強情報の公開       | 全情報公開 | プログラミング言語の勉強の有無のみ公開 |

## ゲームの終了

10ターン目が終わると、ゲームが終了し、信者数の計算に入る。

プログラミング言語からもらえる信者数は、そのプログラミング言語に対する信仰度を他のプレイヤーと比べて決められる。
そのプログラミング言語に対する信仰度が全プレイヤー中で最も高い場合は、注目度と同じ点数を獲得する。
逆に全プレイヤー中で最も低い場合は、注目度と同じ点数を失う。
トップや最下位のプレイヤーが複数いる場合は、注目度をそれらのプレイヤーの人数で割った点だけ得点あるいは失点する。

各プレイヤーの信者数を全員のプログラミング言語に対して計算したら、最も信者数の高いプレイヤーが勝利する。
信者数トップのプレイヤーが複数いる場合は、そのゲームは引き分けとなる。

## AIの入出力形式

AIはゲーム開始時に実行される。
ゲームを始める準備ができたら`READY`と出力したのち、ゲームの設定を入力として受け取る。
また、ターンごとに現在の情報を入力として受け取り、そのターンでの勉強言語を出力する。

AIの思考時間には制限がある。
制限時間を超過するとAIプログラムが強制的に停止され、それ以降の行動が「全日程で0番のプログラミング言語を勉強する」として処理される。

### 準備完了メッセージの出力形式

ゲームを開始する準備ができたら、`READY`と標準出力に出力する。
ゲーム開始から5秒以内に出力がなければ、AIプログラムが強制的に停止される。

### ゲーム設定の入力形式

ゲーム開始時、つまり1ターン目の初めに、ゲームの設定が以下のフォーマットで標準入力に渡される。

<pre>
T P H
E<sub>0</sub> E<sub>1</sub> E<sub>2</sub> ... E<sub>7</sub>
</pre>

* T: 全ターン数。
* P: プレイヤー数。
* H: プログラミング言語の数。
* E<sub>n</sub>: プログラミング言語nの注目度。

### ターン情報の入力形式

各ターンの初めに、現在の情報が以下のフォーマットで標準入力に渡される。

<pre>
T D
L<sub>00</sub>　L<sub>01</sub> L<sub>02</sub> L<sub>03</sub>
L<sub>10</sub>　L<sub>11</sub> L<sub>12</sub> L<sub>13</sub>
L<sub>20</sub>　L<sub>21</sub> L<sub>22</sub> L<sub>23</sub>
:
:
L<sub>70</sub>　L<sub>71</sub> L<sub>72</sub> L<sub>73</sub>
R<sub>0</sub> R<sub>1</sub> R<sub>2</sub> ... R<sub>7</sub>
B<sub>0</sub> B<sub>1</sub> B<sub>2</sub> ... B<sub>7</sub>
</pre>

* T: 現在のターン数。1から始まる。
* D: 平日の場合は"W", 休日の場合は"H"。
* L<sub>nm</sub>: プログラミング言語nに対するプレイヤーmの公開されている（つまり平日の情報のみでわかる）信仰度。このAIプレイヤー自身はプレイヤー0である。
* R<sub>n</sub>: プログラミング言語nに対するこのAIプレイヤーの真の（つまり休日も合わせた）信仰度。
* B<sub>n</sub>: プログラミング言語nが前日の休日に勉強をした(1)かしていない(0)か。

B<sub>0</sub> B<sub>1</sub> B<sub>2</sub> ... B<sub>7</sub>の行は、平日のターンでのみ含まれる。

### 行動の出力形式

そのターンでの勉強言語は、以下のフォーマットで標準出力に出力する。

* __平日の場合__

  <pre>
  H<sub>0</sub> H<sub>1</sub> H<sub>2</sub> H<sub>3</sub> H<sub>4</sub>
  </pre>
  
* __休日の場合__

  <pre>
  H<sub>0</sub> H<sub>1</sub>
  </pre>

H<sub>n</sub>: 勉強言語のプログラミング言語の番号（0から7で指定）。H<sub>0</sub>からH<sub>4</sub>の順番は関係しない。

一度行動を出力すると、そのAIのターンは終了となる。
なお、ターン開始から1秒以内に出力がなければ、AIプログラムが強制的に停止される。

<a name="PseudoCode"></a>

## ルールの疑似コード

    heroine = (enthusiasm, revealed_love[4], real_love[4])

    main:
        init
        while turn <= 10:
            process_turn
            turn += 1
        finish

    init:
        players = player[4]
        heroines = heroine[8] (rand(3, 6), [0, 0, 0, 0], [0, 0, 0, 0])
        turn = 1

    process_turn:
        for h in heroines:
            display_to_all_players(h.enthusiasm)
            display_to_all_players(h.revealed_love)
            if not is_holiday:
                display_to_all_players(h.dated)
            h.dated = false

        for p in players:
            for i in [1 .. (is_holiday ? 2 : 5)]:
                target = heroines[p.selected[i]]
                target.revealed_love[p] += (is_holiday ? 0 : 1)
                target.real_love[p] += (is_holiday ? 2 : 1)
                target.dated = true

    is_holiday:
        turn % 2 == 0

    finish:
        for h in heroines:
            best_players = players.max_by(p -> h.real_love[p])
            for p in best_players:
                p.popularity += h.enthusiasm / best_players.size

            worst_players = players.min_by(p -> h.real_love[p])
            for p in worst_players:
                p.popularity -= h.enthusiasm / worst_players.size

        winners = players.max_by(p -> p.popularity)
        draw if winners.size > 1
